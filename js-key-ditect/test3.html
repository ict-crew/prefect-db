<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            background-color: rgb(24, 24, 24);
        }
        h1{
            font-size: 60px;
            color: white;
        }
    </style>
</head>
<body>

    <h1 id="guss">Heshani I Love You</h1>




    <script>

        const lettersPattern = /[a-z]/; // /^[A-Za-z][A-Za-z0-9]*$/;
        let currentGuessCount = 1;
        let currentGuess = document.querySelector('#guess' + currentGuessCount);

        // detect keypress (letter, backspace, enter, other)
        document.addEventListener('keydown', (e) => {
        //console.log('keypress: ' + e.key);
        let keypress = e.key;
        if (currentGuessCount < 7) {
            if (
            keypress.length == 1 &&
            lettersPattern.test(e.key) &&
            currentGuess.dataset.letters.length < 5
            ) {
            console.log('is letter');
            updateLetters(keypress);
            } else if (e.key == 'Backspace' && currentGuess.dataset.letters != '') {
            //console.log('is backspace');
            deleteFromLetters();
            } else if (e.key == 'Enter' && currentGuess.dataset.letters.length == 5) {
            submitGuess();
            }
        }
        });

        const submitGuess = () => {
        //console.log('submit guess');
        for (let i = 0; i < 5; i++) {
            setTimeout(() => {
            revealTile(i, checkLetter(i));
            }, i * 200);
        }
        };

        const checkIfGuessComplete = (i) => {
        if (i == 4) {
            checkWin();
        }
        };

        const jumpTiles = () => {
        //console.log('jumpTiles');
        //console.log(currentGuessCount);
        for (let i = 0; i < 5; i++) {
            setTimeout(() => {
            let currentTile = document.querySelector(
                '#guess' + currentGuessCount + 'Tile' + (i + 1)
            );
            currentTile.classList.add('jump');
            }, i * 200);
        }
        };

        const checkWin = () => {
        //console.log('check win');
        if (solutionWord == currentGuess.dataset.letters) {
            // Win
            //console.log('game is won!');
            setTimeout(() => {
            jumpTiles();
            }, 500);
        } else {
            // Not won
            currentGuessCount = currentGuessCount + 1;
            currentGuess = document.querySelector('#guess' + currentGuessCount);
            //console.log('not a win, increment guess count to ' + currentGuessCount);
            if (currentGuessCount == 7) {
            setTimeout(() => {
                showSolution();
            }, 500);
            }
        }
        };

        const showSolution = () => {
        alert('Better luck next time. The solution was: ' + solutionWord);
        };

        // Update "letters"
        const updateLetters = (letter) => {
        let oldLetters = currentGuess.dataset.letters;
        let newLetters = oldLetters + letter;
        let currentTile = newLetters.length;
        currentGuess.dataset.letters = newLetters;
        //console.log('currentTile = ' + currentTile);
        updateTiles(currentTile, letter);
        };

    </script>
</body>
</html>